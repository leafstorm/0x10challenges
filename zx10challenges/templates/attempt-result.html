{# inherits `challenge` and `submission` #}

{%- from "_utils.html" import success -%}

{### Macros ###}

{%- macro show_notes_and_metrics (sub_or_case, metrics) -%}
    <table class="table table-condensed">
        {% for comment in sub_or_case.comments %}
            <tr>
                <td colspan="2">{{ comment }}</td>
            </tr>
        {% endfor %}
        {% for violation in sub_or_case.violations %}
            <tr>
                <td colspan="2" class="text-error">{{ violation }}</td>
            </tr>
        {% endfor %}
        {% for metric in metrics %}
            <tr>
                <td>{{ metric.name }}</td>
                <td>
                    {% if metric.id in sub_or_case.metrics %}
                        {{ metric.format(sub_or_case.metrics[metric.id]) }}
                    {% else %}
                        &mdash;
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
{%- endmacro -%}


{### Actual text ###}

<p class="lead text-{{ success(submission.passed) }}">
    {{ submission.caption }}
</p>

{{ show_notes_and_metrics(submission.metrics, challenge.metrics) }}


{% for case in submission.test_cases %}
    <hr>

    <h4 class="text-{{ success(case.passed) }}">
        {{ case.title }}
    </h4>

    <div>
        {% if case.input or case.expected_output or
              case.actual_output %}
            <dl>
                {% if case.input %}
                    <dt>Input:</dt>
                    <dd>{{ case.input }}</dd>
                {% endif %}
                {% if case.expected_output %}
                    <dt>Expected:</dt>
                    <dd>{{ case.expected_output }}</dd>
                {% endif %}
                {% if case.actual_output %}
                    <dt>Actual:</dt>
                    <dd>{{ case.actual_output }}</dd>
                {% endif %}
            </dl>
        {% endif %}

        {{ show_notes_and_metrics(case, challenge.case_metrics) }}
    </div>
{% endfor %}
